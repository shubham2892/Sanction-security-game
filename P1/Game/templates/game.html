{% extends 'base.html' %}
{% load humanize %}
{% load staticfiles %}
{% load bootstrap_tags %}

{% block head_css %}
<link href="{% static 'css/game.css' %}" rel="stylesheet">
{% endblock %}

{% block navbar %}
<div class="game-header">
    <h3 id="game-number">Game#:&nbsp; {{ game.game_key }}</h3>
    <h3 id="time-remaining">Remaining Moves: {{ game.ticks }}</h3>
</div>
{% endblock %}

{% block content %}

<!-- START Fluid Scaffold -->
<div class="row">

    <!-- START Game Information -->

    <div class="col-md-3">
        {% for player in game.players.all %}
        <div class="panel panel-primary">
            <div class="panel-heading">
                <div>
                    {% if player.user == request.user %}
                    <span class="glyphicon glyphicon-user"></span>&nbsp;Player {{ forloop.counter|apnumber|capfirst}} (Me)
                    {% else %}
                    <span class="glyphicon glyphicon-user"></span>&nbsp;Player {{ forloop.counter|apnumber|capfirst }}
                    <button id="sanction" type="button" class="btn btn-sm btn-danger pull-right">Sanction</button>
                    {% endif %}
                </div>
            </div>
            <div class="panel-body">
                <table class="info-text">
                    <tr id="score">
                        <td>
                            Score:
                        </td>
                        <td colspan="3">
                            <div class="progressbar"></div>
                        </td>
                        <tr>
                            <td>
                                Vulnerabilities:
                            </td>
                            <!-- Blue Security Resource -->
                            <td>
                                <div id="blue" class="resource-container vulnerable">
                                    <span class="centerer"></span><span class='centered'></span>
                                </div>
                            </td>

                            <!-- Red Security Resource -->
                            <td>
                                <div id="red" class="resource-container vulnerable">
                                    <span class="centerer"></span><span class='centered'></span>
                                </div>
                            </td>

                            <!-- Yellow Security Resource -->
                            <td>
                                <div id="yellow" class="resource-container vulnerable">
                                    <span class="centerer"></span><span class='centered'></span>
                                </div>
                            </td>
                        </tr>
                    </table>
                </div>
            </div>
            {% endfor %}
        </div>

        <!-- END Game Information -->

        <!-- START Player Pane -->

        <div class="col-md-4">
            <div class="panel panel-primary">
                <div class="panel-heading">
                    <div>
                        <span><span class="glyphicon glyphicon-user"></span>
                        &nbsp;Me</span>
                        <span id="score">
                            &nbsp;Score: <b> 57 Points</b>
                        </span>
                    </div>
                </div>
                <div class="panel-body gameboard">

                    <!-- START Resource Objectives -->
                    <div class="objectives">
                        <div class="section-header">
                            <h3> Research Objectives: </h3>
                        </div>

                        <table class="category-list">
                            <tbody>

                                <!-- START Workshop Objective -->
                                <tr class="resource-list">
                                    <td>
                                        <h4 class="objective-category">Workshop:</h4>
                                    </td>
                                    <td>
                                        <div id="yellow" class="resource-container incomplete">
                                            <span class="centerer"></span><span class='centered'></span>
                                        </div>
                                    </td>
                                </tr>
                                <!-- END Workshop Objective -->

                                <!-- START Conference Objective -->
                                <tr class="resource-list">
                                    <td>
                                        <h4 class="objective-category">Conference:</h4>
                                    </td>
                                    <td>
                                        <div  id="blue" class="resource-container incomplete">
                                            <span class="centerer"></span><span class='centered'></span>
                                        </div>
                                    </td>
                                    <td>
                                        <div id="yellow" class="resource-container incomplete">
                                            <span class="centerer"></span><span class='centered'></span>
                                        </div>
                                    </td>
                                </tr>
                                <!-- END Conference Objective -->

                                <!-- START Journal Objective -->
                                <tr class="resource-list">
                                    <td>
                                        <h4 class="objective-category">Journal:</h4>
                                    </td>
                                    <td>
                                        <div  id="blue" class="resource-container incomplete">
                                            <span class="centerer"></span><span class='centered'></span>
                                        </div>
                                    </td>
                                    <td>
                                        <div id="yellow" class="resource-container incomplete">
                                            <span class="centerer"></span><span class='centered'></span>
                                        </div>
                                    </td>
                                    <td>
                                        <div id="red" class="resource-container incomplete">
                                            <span class="centerer"></span><span class='centered'></span>
                                        </div>
                                    </td>
                                </tr>
                                <!-- END Journal Objective -->

                            </tbody>
                        </table>

                    </div>
                    <hr>
                    <!-- END Resource Objectives -->


                    <!-- START Security Features -->

                    <div class="objectives">
                        <div class="section-header">
                            <h3>Security Objectives:</h3>
                        </div>
                        <table class="category-list">
                            <tbody>
                                <tr>
                                    <td>
                                        <h4 class="objective-category">Vulnerabilities:</h4>
                                    </td>
                                    <!-- Blue Security Resource -->
                                    <td>
                                        <div id="blue" class="resource-container vulnerable">
                                            <span class="centerer"></span><span class='centered'></span>
                                        </div>
                                    </td>

                                    <!-- Red Security Resource -->
                                    <td>
                                        <div id="red" class="resource-container vulnerable">
                                            <span class="centerer"></span><span class='centered'></span>
                                        </div>
                                    </td>

                                    <!-- Yellow Security Resource -->
                                    <td>
                                        <div id="yellow" class="resource-container vulnerable">
                                            <span class="centerer"></span><span class='centered'></span>
                                        </div>
                                    </td>
                                </tr>

                                <tr>
                                    <td>
                                        <h4 class="objective-category">Capabilities:</h4>
                                    </td>
                                    <!-- Blue Security Resource -->
                                    <td>
                                        <div id="blue" class="resource-container capable">
                                            <span class="centerer"></span><span class='centered'></span>
                                        </div>
                                    </td>

                                    <!-- Red Security Resource -->
                                    <td>
                                        <div id="red" class="resource-container capable">
                                            <span class="centerer"></span><span class='centered'></span>
                                        </div>
                                    </td>

                                    <!-- Yellow Security Resource -->
                                    <td>
                                        <div id="yellow" class="resource-container capable">
                                            <span class="centerer"></span><span class='centered'></span>
                                        </div>
                                    </td>
                                </tr>

                            </tbody>
                        </table>
                    </div><!--- close .objectives -->
                </div><!--- close .panel-body-->
            </div><!-- close .panel .panel-primary -->
        </div><!-- close col-md-4 -->

        <!-- END Security Tasks -->

        <!-- START Attack Information -->

        <div class="col-md-2 attack">
            <div class="panel panel-primary">
                <div class="panel-heading attack-heading">
                    <div>
                        <span class="glyphicon glyphicon-screenshot"></span>&nbsp; Attack
                    </div>
                </div>
                <div class="panel-body attack-active">
                    <div id="yellow" class="resource-container complete centered">
                        <span class="centerer"></span><span class='centered'></span>
                    </div>
                </div>
            </div>



            <div class="panel panel-primary">
                <div class="panel-heading attack-heading">
                    <div>
                        <span class="glyphicon glyphicon-screenshot"></span>&nbsp; Threat
                    </div>
                </div>
                <div class="panel-body attack-threat">
                    <div class="outer">
                        <div class="inner blue" blue-threat="20%">
                            <div></div>
                        </div>
                        <div class="inner red" red-threat="20%">
                            <div></div>
                        </div>
                        <div class="inner yellow" yellow-threat="60%">
                            <div></div>
                        </div>
                    </div>
                </div> <!-- close panel-body -->
            </div> <!-- close panel panel-primary -->
        </div><!-- close .col-md-2 -->

        <!-- END Attack Information -->

        <!-- END Player Pane -->


        <!-- START Chat Window -->

        <div class="col-md-3">
            <div class="panel panel-primary">
                <div class="panel-heading">
                    <span class="glyphicon glyphicon-comment"></span>&nbsp;Group Chat
                </div>
                <div class="panel-body chat">
                    <ul class="chat">
                        {% for message in game.message_set.all %}
                        <li class="clearfix">
                            <div class="chat-body clearfix">
                                <div class="header">
                                    {% if message.speaker.user == request.user %}
                                    <strong class="primary-font">Player {{ message.anonymize | apnumber | capfirst }} (Me)</strong>
                                    {% else %}
                                    <strong class="primary-font">Player {{ message.anonymize | apnumber | capfirst }}</strong>
                                    {% endif %}
                                </div>
                                <p>
                                   {{ message.content }}
                               </p>
                           </div>
                       </li>
                       {% endfor %}
                   </ul>
               </div>
               <div class="panel-footer">
                <form class="form-inline" action="" method="POST">
                    {% csrf_token %}
                    {{ message | as_bootstrap }}
                    <input class="btn btn-warning btn-sm" id="btn-chat" type="submit" value="Send"></input>
                </form>
            </div>
        </div>

        <!-- END Chat Window -->

    </div>
</div>
<!-- END Fluid Scaffold -->

{% endblock %}

{% block footer %}
<hr>
{% endblock %}

{% block body_js %}
<script src="{% static 'js/game.js' %}"></script>
{% endblock %}
