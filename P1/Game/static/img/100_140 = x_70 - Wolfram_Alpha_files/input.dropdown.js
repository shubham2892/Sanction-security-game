var iMathTimeout=0;var autocompleteReq=null;var summaryBoxReq=null;var prevFirst="";function inputDropdown(){var A=$("#i").val();if(!$("#imath").html()){$("#imath").append('<div class="im"></div>').append('<div class="ac"></div>').append('<ul class="moreInput">				<li class="inputtab inputtab-keyboard" data-tab="keyboard"><a href="#"></a></div>				<li class="inputtab inputtab-images" data-tab="images"><a href="#"></a></div>				<li class="inputtab inputtab-datainput" data-tab="datainput"><a href="#"></a></div>				<li class="inputtab inputtab-genfiles" data-tab="genfiles"><a href="#"></a></div>		</ul>')}autocomplete(A,"/input/autocomplete.jsp?qr=0&",$("#imath .ac"))}function autocomplete(C,B,A){if(autocompleteReq){autocompleteReq.abort()}var D=A;if(D.length<=0){D=$("#imath .ac")}if(C&&C!=""){autocompleteReq=$.getJSON(B+"i="+encodeURIComponent(C),function(I){var K="";var J=$("#i").val();if(I.results&&I.results.length>0&&I.query==J){$.each(I.results,function(O,P){if(O>=6){return false}K+='<div class="ac-a"> <a href="'+P.waPath+'" data-pos="'+(O+1)+'" data-sb="'+P.summaryBoxPath+'" data-input="'+P.input+'"><b>'+P.input.substring(0,C.length)+"</b>"+P.input.substring(C.length)+"</a></div>"});if(K.trim().length>0){D.html(K).show().parent().show();var F=$(".ac-a a").first();showSummaryBox(F.data("sb"),F,true);$("#input").addClass("imath")}}else{closeInputDropDown(true)}if(I.instantMath){$("#sb-con").addClass("has-instant-math");$("#sb-con").removeClass("no-instant-math");hideSummaryBox();var G=$("#imath .im");var L=I.instantMath.exactResult;var N=I.instantMath.approximateResult;var E="";if(L){E=L}else{E=N}if(E){E=$.trim(E);if(E.toLowerCase()!=J.trim()){var M=/\*\^\-*\d+/;var H=E.match(M);if(H){H=H+"";E=E.replace(M,"&times;10<sup>"+H.substring(2)+"</sup>")}if(E.substring(I.length-1)=="."){E=E.substring(0,I.length-1)}G.html(C+"<b> = "+E+"</b>").show().parent().show();$("#input").addClass("imath")}}}else{$("#sb-con").removeClass("has-instant-math");$("#sb-con").addClass("no-instant-math")}})}else{closeInputDropDown(true)}}function selectInput(H,G){var C=$("#imath a.selected",$(G).parent());var I=$("#imath .ac-a > a",$(G).parent());var F="";if(H==38){var B=$("a",C.parent().prevAll(".ac-a")).first();if(B.length>0){C.removeClass("selected");B.addClass("selected");F=B.data("input")}else{C.removeClass("selected")}}else{if(H==40){if(C.length>0){var D=$("a",C.parent().nextAll(".ac-a")).first();if(D.length>0){C.removeClass("selected");D.addClass("selected");F=D.data("input")}else{C.removeClass("selected");$(I).first().addClass("selected");F=$(I).first().data("input")}}else{$(I).first().addClass("selected");F=$(I).first().data("input")}}}var A=$("#imath a.selected",$(G).parent());var E=A.data("sb");showSummaryBox(E,A);if(F.trim().length>0){$("#i").val("").val(F)}}function closeInputDropDown(A){$("#imath .im").hide();if($("#i").val().trim().length==0||A){$("#imath").hide();$("#input").removeClass("imath")}}function hasFileInput(){return $("#input .inputfile-tag").length>0}function showSummaryBox(B,C,A){if(B&&B.length>1&&typeof (B)!=undefined&&B!="undefined"&&($("#wrap").hasClass("rw-large")||$("#wrap").hasClass("rw-xlarge")||$("#calculate").hasClass("index"))){var D=$("a",C).data("pos")?$("a",C).data("pos"):$(C).data("pos");if($("#imath").data("sb")==B&&$("#sb-con").length>0){$("#sb-con").removeClass("pos0 pos1 pos2 pos3 pos4 pos5 pos6").addClass("pos"+D).show();$("#imath").data("sb-input",$(C).data("input"));$(".ac").addClass("sb")}else{$("#sb-con").remove();summaryBoxReq=$.get("/Calculate/XnaDDI.jsp?GIxCQ="+makeid(2)+replaceAll(reverse(B),"/","|")+makeid(10),function(E){$("#sb-con").remove();$("#imath").append('<div id="sb-con" class="callout left no-instant-math pos'+D+'" >'+E+"</div>").show();$("#imath").data("sb",B).data("sb-input",$(C).data("input")).data("sb-pos",D);$(".ac").addClass("sb")}).fail(function(){hideSummaryBox()})}$.get("/prompt.txt",{feature:"sb",pos:D,url:makeid(2)+replaceAll(reverse(B),"/","|")+makeid(10),input:$("a",C).data("input"),first:A,ts:new Date().getTime()})}else{hideSummaryBox()}prevFirst=$(C).data("input")}function hideSummaryBox(){$("#sb-con").hide();$(".ac").removeClass("sb");if(summaryBoxReq){summaryBoxReq.abort()}}function makeid(D){var C="";var A="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(var B=0;B<D;B++){C+=A.charAt(Math.floor(Math.random()*A.length))}return C}function reverse(A){return A.split("").reverse().join("")}function replaceAll(C,B,A){return C.replace(new RegExp(B,"g"),A)};